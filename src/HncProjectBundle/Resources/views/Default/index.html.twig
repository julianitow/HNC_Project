{% extends '@HncProject/Default/template.html.twig' %}


{% block head %}
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {'packages':['line']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {

            var data = new google.visualization.DataTable();
            data.addColumn('number', 'Day');
            data.addColumn('number', '{{ symbol_result }}');

            data.addRows([
                [1,  37.8],
                [2,  30.9],
                [3,  25.4],
                [4,  11.7],
                [5,  11.9],
                [6,   8.8],
                [7,   7.6],
                [8,  12.3],
                [9,  16.9],
                [10, 12.8],
                [11,  5.3],
                [12,  6.6],
                [13,  4.8],
                [14,  4.2]
            ]);

            var options = {
                chart: {
                    title: 'Share state',
                    subtitle: 'in pounds'
                },
                width: 900,
                height: 500,
                axes: {
                    x: {
                        0: {side: 'top'}
                    }
                }
            };

            var chart = new google.charts.Line(document.getElementById('line_top_x'));

            chart.draw(data, google.charts.Line.convertOptions(options));
        }
    </script>

{% endblock %}

{% block body_first %}
    <div class="row">
        <div class="col-sm-9 inline ftse_datas">
            {% if error_code == "error_connection_01" %}
                <div class="alert alert-danger">Source unreachable, sorry.</div>
            {% else %}
                {% for share in ftse_data['ShareData'] %}
                    <div class="slide ftse_share">
                        <strong>{{ share['Sym'] }}</strong> <br>
                        {{ share['Name'] }} <br>
                        Current price: {{ share['CurPrice'] }} <br>
                        {% if share['Chg'] < 0 %}
                            Chg: <a id="Chg_neg"> {{ share['Chg'] }} <i class="fas fa-caret-down"></i></a>
                        {% elseif share['Chg'] > 0 %}
                            Chg: <a id="Chg_pos"> {{ share['Chg'] }} <i class="fas fa-caret-up"></i></a>
                        {% else %}
                            Chg: {{ share['Chg'] }}
                        {% endif %}
                    </div>
                {% endfor %}
            {% endif %}
        </div><!-- col ftse_datas -->
        <div class="col-sm-3">
            <h3>FLASH NEWS:</h3>
            <div class="article_container">
                {% for article in articles %}
                    <div class="article">
                        <div class="home_card">
                            <div class="article card_header">
                                {{ article.source.name }}
                            </div>
                            <div class="card_picture">
                                <img src="{{ article.urlToImage }}" width="100%">
                            </div>
                            <div id="text_article" class="card_body">
                                <center><strong>{{ article.title }}</strong></center><br>
                                {{ article.description }}
                            </div>
                            <div class="card_footer text-center">
                                <i class="fas fa-user-edit"></i> {{ article.author }}<br>
                                <i class="fas fa-calendar-check"></i> Published on {{ article.publishedAt|date("m/d/Y") }}<br>
                                <a href="{{ article.url }}"><i class="fas fa-link"></i> See more</a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div><!-- row -->
{% endblock %}
{% block body_container %}
    <div class="row">
        <div class="col-lg-2">
            <div class="container-fluid" id ="body_content">
                    <br>
                    <h3>Contents:<br></h3>
                    {% if search_result_data != null %}
                    Search result:<br>
                    <div class="share">
                        <div class="home_card">
                            <div class="article card_header">
                                {% if symbol_result != null %}
                                    {{ symbol_result }}
                                {% endif %}
                                {#{{ dump(search_result_data) }}#}
                            </div>
                            <div id="text_article" class="card_body">
                                <ul>
                                    <li>Open: {{ attribute(search_result_data, "1. open") }}</li>
                                    <li>High: {{ attribute(search_result_data, "2. high") }}</li>
                                    <li>Low: {{ attribute(search_result_data, "3. low") }}</li>
                                    <li>Close: {{ attribute(search_result_data, "4. close") }}</li>
                                    <li>Volume: {{ attribute(search_result_data, "5. volume") }}</li>
                                </ul>
                            </div>
                            <div class="card_footer text-center">
                                <i class="fas fa-calendar-check"></i> {{ search_result_day }}<br>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div><!-- row -->
                <div class="row">
                    <div class="col">
                    </div>
                </div>
        </div>
        <div class="col-lg-6">
            <div id="line_top_x"></div>
        </div>
    </div>
{% endblock %}

{% block footer %}

{% endblock %}
